# Raspberry Pi Home Assistant è½åœ°å®žæˆ˜æ‰‹å†Œ (æ‰‹æœºçƒ­ç‚¹ç‰ˆ)

## ðŸ›  çŽ¯å¢ƒå‡†å¤‡
- ç¡¬ä»¶ï¼šRaspberry Pi 4B/5ï¼ˆARM64 æž¶æž„ï¼‰
- ç³»ç»Ÿï¼šUbuntu Desktop / Server 22.04+
- ç½‘ç»œï¼šå»ºè®®å‡†å¤‡ä¸¤å°ç§»åŠ¨è®¾å¤‡ï¼ˆä¸€å°å¼€çƒ­ç‚¹ï¼Œä¸€å°æ“ä½œï¼‰ï¼Œæˆ–ä½¿ç”¨è·¯ç”±å™¨ã€‚
## ðŸš€ å¿«é€Ÿå¼€å§‹
### ï¼ˆä¸€ï¼‰ åŸºç¡€çŽ¯å¢ƒæ­å»º (Docker)

#### 1.æ‰“å¼€ç»ˆç«¯ï¼š
```
# è¿›å…¥ä½ çš„ä¸ªäººä¸»ç›®å½•
cd ~ 
#åˆ›å»ºä¸€ä¸ªä¸“é—¨æ”¾ Home Assistant é…ç½®çš„æ–‡ä»¶å¤¹
mkdir -p homeassistant/config
#è¿›å…¥è¿™ä¸ªæ–‡ä»¶å¤¹æŸ¥çœ‹è·¯å¾„
cd homeassistant/config
pwd
é€šå¸¸æ˜¯ /home/ubuntu/homeassistant/config
```

#### 2. æ›´æ–°ç´¢å¼•å¹¶å®‰è£…å¿…è¦çš„å·¥å…·
```
sudo apt update
sudo apt install ca-certificates curl gnupg lsb-release -y
```
#### 3.æ·»åŠ  docker å®˜æ–¹å¯†é’¥

```
sudo mkdir -p /etc/apt/keyrings
```
ä½¿ç”¨å›½å†…é•œåƒæºæ·»åŠ å¯†é’¥ï¼š
```
curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
```

#### 4. æŠŠ Docker çš„ä¸‹è½½åœ°å€åŠ å…¥ç³»ç»Ÿçš„â€œç™½åå•â€ï¼Œå†™å…¥è½¯ä»¶æº

```

echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://mirrors.aliyun.com/docker-ce/linux/ubuntu \
  $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
```

#### 5. æ­£å¼å®‰è£… Docker å¼•æ“Ž
```
sudo apt update
sudo apt install docker-ce docker-ce-cli containerd.io -y
å¦‚ä½•ç¡®è®¤æ˜¯å¦æˆåŠŸï¼Ÿ
å®‰è£…å®ŒæˆåŽï¼Œå†æ¬¡è¾“å…¥ï¼š
docker --version
```

### ï¼ˆäºŒï¼‰ Home Assistant éƒ¨ç½²

> é’ˆå¯¹ ARM64 æž¶æž„ï¼Œå»ºè®®å¼ºåˆ¶æŒ‡å®šå¹³å°é•œåƒä»¥ç¡®ä¿å…¼å®¹æ€§ã€‚

å› ä¸ºHome Assistantçš„é•œåƒæºåœ¨å›½å¤–ï¼Œç›´æŽ¥ä¸‹è½½å¯èƒ½ä¼šå¡ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨å›½å†…çš„é•œåƒæºä¸‹è½½ï¼š
#### 1. æ‹‰å–é•œåƒæº
```
sudo docker pull docker.m.daocloud.io/homeassistant/home-assistant:stable
```
#### 2. æ£€æŸ¥é•œåƒè¯¦ç»†ä¿¡æ¯ï¼ˆå…³é”®ï¼šç¡®è®¤æž¶æž„ï¼‰
```
sudo docker inspect docker.m.daocloud.io/homeassistant/home-assistant:stable | grep Architecture
```
#### 3. å¼ºåˆ¶ä»¥â€œæŒ‡å®šæž¶æž„â€æ¨¡å¼è¿è¡Œ
åœ¨è¿è¡Œå‘½ä»¤æ—¶ï¼Œæˆ‘ä»¬å†æ¬¡å£°æ˜Žå¹³å°ï¼Œå¹¶ä½¿ç”¨åˆšæ‰ä¸‹è½½çš„æ–°åœ°å€ï¼š
- **æ³¨æ„**ï¼šæ­¤å¤„æˆ‘ä»¬å°†é…ç½®è·¯å¾„ç»Ÿä¸€ä¸º ```~/hass_config```
```
sudo docker run -d \
  --name homeassistant \
  --privileged \
  --restart=unless-stopped \
  --platform linux/arm64 \
  -e TZ=Asia/Shanghai \
  -v /home/$USER/hass_config:/config \
  --network=host \
  docker.m.daocloud.io/homeassistant/home-assistant:stable

```

#### 4.ç¡®è®¤è¿è¡ŒçŠ¶æ€ï¼š
>>```
>>sudo docker ps
>>```
>> * æ‰¾åˆ° homeassistant é‚£ä¸€è¡Œã€‚
>> * æ£€æŸ¥ STATUS è¿™ä¸€åˆ—ã€‚å¦‚æžœæ˜¯ Up ... seconds æˆ–è€… Up ... minutesï¼Œé‚£å°±å½»åº•ç¨³äº†ï¼
>> * å¦‚æžœå®ƒæ˜¾ç¤º Restarting...ï¼Œè¯´æ˜Žè¿˜æœ‰å°é—®é¢˜ï¼Œä½†é€šå¸¸çŽ°åœ¨åº”è¯¥æ˜¯ Upã€‚
#### 5. è¿›å…¥Home Assistantç•Œé¢
>> * çŽ°åœ¨å¯ä»¥ç¦»å¼€ç»ˆç«¯ï¼Œå›žåˆ°ä½ çš„ç”µè„‘ï¼ˆWindows/Macï¼‰æµè§ˆå™¨äº†
>> * æ‰“å¼€æµè§ˆå™¨ï¼ˆå»ºè®®ç”¨ Chromeã€Edge æˆ– Safariï¼‰ã€‚
>> * è¾“å…¥åœ°å€ï¼š http://ä½ çš„æ ‘èŽ“æ´¾IP:8123
>>ï¼ˆå¦‚æžœä½ å¿˜äº† IPï¼Œåœ¨æ ‘èŽ“æ´¾è¾“å…¥ ```hostname -I``` æŸ¥çœ‹ï¼‰
>> * ç­‰å¾…ï¼š ç¬¬ä¸€æ¬¡å¯åŠ¨å¯èƒ½éœ€è¦ 1-2 åˆ†é’Ÿæ¥åˆå§‹åŒ–æ•°æ®åº“ã€‚

>> ## å› ä¸ºç”µè„‘å’Œæ ‘èŽ“æ´¾è¿žæŽ¥çš„éƒ½æ˜¯æ‰‹æœºçš„çƒ­ç‚¹ï¼š
>> æ‰€ä»¥åœ¨ç”µè„‘ä¸Šhttp:æ ‘èŽ“æ´¾IP:8123å°±æ‰“ä¸å¼€è¿™ä¸ªç½‘é¡µ
![alt text](image.png)
æƒ…å†µå¦‚ä¸Š

> æ ‘èŽ“æ´¾ä¸Šï¼šé€šè¿‡æŸ¥çœ‹HomeAssistantå®žæ—¶æ—¥å¿—ï¼š
>>```
>>sudo docker logs --tail 20 homeassistant
>>```
>- æ­£å¸¸æƒ…å†µï¼šä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼ Home Assistant is running æˆ–è€… Starting Home Assistant...ã€‚
>- å¼‚å¸¸æƒ…å†µï¼šå¦‚æžœæ²¡æœ‰ä»»ä½•è¾“å‡ºï¼Œæˆ–è€…å…¨æ˜¯ Errorï¼Œè¯´æ˜Žå®¹å™¨å†…éƒ¨å‡ºé—®é¢˜äº†ã€‚
> ![alt text](e40aa5c81e82d1461c0b01e532451c3b_720.jpg)

>> ä½†æ˜¯è¿˜å¥½ï¼Œæ ¹æ®æ ‘èŽ“æ´¾ä¸Šçš„Error:æ—¥å¿—é‡Œå…¨æ˜¯ habluetooth.scanner å’Œ hci0ã€‚è¿™åªæ˜¯è¯´ Home Assistant åœ¨å°è¯•æœç´¢ä½ å®¶é‡Œçš„è“ç‰™è®¾å¤‡ï¼Œä½†æ ‘èŽ“æ´¾çš„è“ç‰™æ²¡é…ç½®å¥½æˆ–è€…è¢«å ç”¨äº†ã€‚è¿™å®Œå…¨ä¸å½±å“ä½ è¿›å…¥ç½‘é¡µç³»ç»Ÿã€‚
>> å…³é”®çš„é—®é¢˜åœ¨äºŽï¼š
ä¸­é—´æœ‰ä¸€è¡Œ Network unreachableï¼Œæ˜¯å› ä¸ºç”¨çš„æ˜¯æ‰‹æœºçƒ­ç‚¹ï¼ŒHome Assistant å‘çŽ°æ²¡æ³•è¿žæŽ¥åˆ°äº’è”ç½‘åŽ»ä¸‹è½½å¤©æ°”ã€æ—¶é—´ç­‰æ’ä»¶ï¼Œè¿™ä¹Ÿä¸å½±å“è¿›å…¥æœ¬åœ°åŽå°ã€‚
>### Plan A:ç›´æŽ¥ä½¿ç”¨æ ‘èŽ“æ´¾è‡ªå·±çš„æµè§ˆå™¨æ‰“å¼€
>>åœ°å€æ ç›´æŽ¥è¾“å…¥ï¼šhttp://localhost:8123 æˆ–è€… http://127.0.0.1:8123
å¦‚æžœèƒ½æ‰“å¼€ï¼Œå®‰è£…å°±æ˜¯æ²¡é—®é¢˜çš„
> ### Plan B: è§£å†³æ‰‹æœºçƒ­ç‚¹å±è”½
>>* åœ¨æ ‘èŽ“æ´¾çš„ç»ˆç«¯è¾“å…¥ï¼š sudo ufw allow8123/tcp (æ‰‹åŠ¨æ”¾è¡Œç«¯å£)
>>* æ£€æŸ¥ç”µè„‘è¿žæŽ¥çš„æ˜¯åŒä¸€ä¸ªæ‰‹æœºçƒ­ç‚¹
å¦‚æžœè¿˜æ˜¯ä¸è¡Œï¼šç”¨ USB çº¿æŠŠæ‰‹æœºè¿žåˆ°ç”µè„‘ï¼Œå¼€å¯ â€œUSB å…±äº«ç½‘ç»œâ€ï¼Œè¿™æ ·ç”µè„‘å’Œæ‰‹æœºçƒ­ç‚¹å°±åœ¨åŒä¸€ä¸ªæ›´ç›´æŽ¥çš„å±€åŸŸç½‘é‡Œäº†ã€‚


### ï¼ˆä¸‰ï¼‰  æ’ä»¶å•†åº— (HACS) æ‰‹åŠ¨å®‰è£…
- **éš¾ç‚¹**ï¼šçƒ­ç‚¹çŽ¯å¢ƒä¸‹ GitHub è®¿é—®ä¸ç¨³å®šï¼Œå»ºè®®æ‰‹åŠ¨ä¸‹è½½ zip åŒ…ã€‚
####  1.é‡æ–°æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä¸Ž homeassistantæ–‡ä»¶å¤¹ åŒçº§
```
#è¿›å…¥é…ç½®æ–‡ä»¶å¤¹
cd ~/hass_config

# åˆ›å»º custom_components æ–‡ä»¶å¤¹
mkdir -p custom_components

# åˆ›å»º wwwæ–‡ä»¶å¤¹
mkdir -p www
```

>> æœ‰ä¸€ä¸ªé—®é¢˜ï¼š
>>å°±æ˜¯æˆ‘åœ¨ç»ˆç«¯åˆ›å»ºæ–‡ä»¶å¤¹çš„æ—¶å€™è¯´æˆ‘æ²¡æœ‰æƒé™:
>>```
>>mkdir: cannot create directory 'custom_components': Pession denied

è¿™æ˜¯å› ä¸ºDockeråˆ›å»ºçš„```hass_config```é»˜è®¤ä¸ºrootæƒé™ï¼Œéœ€æ‰‹åŠ¨åˆ›å»ºå¹¶ä¿®æ­£æƒé™ã€‚

>> ä½†æ˜¯æ²¡å…³ç³»ï¼š
>##### ç¬¬ä¸€æ­¥ ï¼šå€Ÿç”¨â€˜è¶…çº§åŠ›é‡â€™ åˆ›å»º
>>åœ¨å‘½ä»¤å‰é¢åŠ ä¸Š sudoï¼Œè¿™è¡¨ç¤ºâ€œä»¥ç®¡ç†å‘˜èº«ä»½æ‰§è¡Œâ€ï¼š
>>```
>>sudo mkdir -p /home/$USER/hass_config/custom_components
>>sudo mkdir -p /home/$USER/hass_config/www

> ##### ç¬¬äºŒæ­¥ï¼šæŠŠæ–‡ä»¶å¤¹çš„â€œæ‰€æœ‰æƒâ€æ‹¿å›žæ¥
>> å³ä¾¿åˆ›å»ºäº†æ–‡ä»¶å¤¹ï¼Œå¦‚æžœâ€œä¸»äººâ€è¿˜æ˜¯ rootï¼ŒHome Assistant ä»¥åŽå¯èƒ½æ²¡æ³•å¾€é‡Œå†™æ•°æ®ã€‚æˆ‘ä»¬éœ€è¦æŠŠæ•´ä¸ªé…ç½®æ–‡ä»¶å¤¹çš„æƒé™äº¤è¿˜ç»™ä½ çŽ°åœ¨çš„ç”¨æˆ·ï¼ˆå‡è®¾ä½ çš„ç”¨æˆ·åæ˜¯ ubuntuï¼‰ï¼š
>>```
>>#å°†æ–‡ä»¶å¤¹çš„æ‰€æœ‰è€…æ”¹ä¸ºå½“å‰ç”¨æˆ·
>>sudo chown -R $USER:$USER /home/$USER/hass_config/
>>
>>
>>#ç»™æ–‡ä»¶å¤¹èµ‹äºˆè¯»å†™æƒé™
>>sudo chmod -R 755 /home/$USER/hass_config/
>>
>**éªŒè¯ä¸€ä¸‹**ï¼šè¾“å…¥ls -l  å¦‚æžœæ–‡ä»¶å¤¹æ—è¾¹çš„ä¸æ˜¯ root root,è€Œæ˜¯ ubuntu ubuntu,è¯´æ˜Žæƒé™ä¿®æ­£æˆåŠŸ

#### 2.ä¸‹è½½hacsæ–‡ä»¶
>åœ¨æ­¤ä¹‹å‰è®°å¾—è¦å…ˆåœ¨custom_componentsæ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªhacsæ–‡ä»¶å¤¹
https://github.com/hacs/integration/releases/latest/download/hacs.zip
>> * å¥½çš„ä¸‹è½½hacsæ–‡ä»¶ä¹‹åŽè¿›è¡Œè§£åŽ‹ï¼Œå°†è§£åŽ‹ç¼©ä¹‹åŽçš„æ–‡ä»¶éƒ½æ”¾åˆ°custom_componentsæ–‡ä»¶å¤¹ä¸­çš„hacsæ–‡ä»¶å¤¹ã€‚
>#### å†æ¬¡ä¿®æ­£æƒé™ï¼š
>>å› ä¸ºä½ æ‰‹åŠ¨æ‹·å…¥äº†æ–°æ–‡ä»¶ï¼Œä¸ºäº†ä¿é™©ï¼Œå†æ¬¡è¿è¡Œä¸€æ¬¡æƒé™æŒ‡ä»¤ï¼Œç¡®ä¿ Home Assistant èƒ½è¯»åˆ°å®ƒä»¬ï¼š
>>```
>>sudo chown -R $USER:$USER /home/$USER/hass_config/custom_components/hacs/
>>sudo chmod -R 755 /home/$USER/hass_config/custom_components/hacs/
>>

#### 3. é‡å¯homeassistant


>1. å›žåˆ° Home Assistant ç½‘é¡µ.
> 2. ç‚¹å‡» é…ç½® (Settings) -> ç³»ç»Ÿ (System) -> å³ä¸Šè§’ é‡æ–°å¯åŠ¨ (Restart)ã€‚
> 3. æˆ–è€…é€‰æ‹© é‡æ–°å¯åŠ¨ Home Assistantã€‚ä¼šæœ‰ä¸€ä¸ªä¸­æ–­æ­£åœ¨è¿è¡Œçš„è‡ªåŠ¨åŒ–å’Œè„šæœ¬æŒ‰é’®ï¼Œæ˜¯çš„æ²¡é”™ç‚¹å‡»é‡å¯homeassistant

#### 4. åœ¨ç•Œé¢ä¸­"æ·»åŠ é›†æˆ"
>>é‡å¯å®ŒæˆåŽï¼ˆå¯èƒ½éœ€è¦ 1-2 åˆ†é’Ÿï¼‰ï¼š
>1. ç‚¹å‡» **é…ç½® (Settings)** -> **è®¾å¤‡ä¸ŽæœåŠ¡ (Devices & Services)**ã€‚
>2. ç‚¹å‡»å³ä¸‹è§’çš„ **æ·»åŠ é›†æˆ (Add Integration)ã€‚**
>3. **æœç´¢ HACS.**
>>æ³¨æ„ï¼š å¦‚æžœæœä¸åˆ°ï¼ŒæŒ‰ Ctrl + F5 å¼ºåˆ¶åˆ·æ–°ç½‘é¡µç¼“å­˜åŽå†æœã€‚
>4. ä¹‹åŽç‚¹å‡» **HACS**è¿™ä¸€æ ï¼Œä¼šå¼¹å‡ºä¸€ä¸ªæ¡†ï¼Œä¼šå‡ºçŽ°4æˆ–5ä¸ªæ¡†æ¡†ï¼Œç„¶åŽå‹¾é€‰ä¸Šï¼Œç‚¹å‡»**æäº¤**
>5. ä¹‹åŽå¼¹å‡ºä¸€ä¸ªæ–°çš„å°æ¡†ï¼Œæœ‰ä¸€è¡Œ**githubçš„é“¾æŽ¥**å’Œä¸‹é¢**ä¸€è¡ŒéªŒè¯ç **ï¼ŒæŠŠéªŒè¯ç ç»™å¤åˆ¶ä¸‹æ¥ï¼Œç‚¹å‡»ä¸Šé¢é‚£ä¸€è¡Œé“¾æŽ¥,ä¹‹åŽè¿™é‡Œå¦‚æžœæ²¡æœ‰githubè´¦å·çš„è¯ï¼Œéœ€è¦è‡ªå·±å†åˆ›å»ºä¸€ä¸ªï¼Œåˆ›å»ºå¥½è´¦å·ä¹‹åŽï¼Œå†æŠŠéªŒè¯ç ç²˜è´´åˆ°ä¸‹é¢çš„æ¡†æ¡†ä¸­ï¼Œç‚¹å‡»**Continue**ï¼Œç„¶åŽå†ç‚¹å‡»**Authorize hacs**
>>ä¹‹åŽå›žåˆ°homeassistant,æˆ‘çŽ°åœ¨çš„é¡µé¢æ˜¯è¿™æ ·çš„ï¼š
>>![alt text](0894e4f5f9d10cd92f7e0c5045e6423a_720.jpg)
>> è¿™é‡Œå¯ä»¥é€‰æ‹©ç›´æŽ¥è·³è¿‡ï¼Œä¹Ÿå¯ä»¥é€‰â€œå®¢åŽ…â€ã€â€œåŠžå…¬å®¤â€

>Home Assistant çš„å·¦è¾¹è¾¹æ å¤šäº†ä¸€ä¸ªå›¾æ ‡å†™ç€â€œHACSâ€ï¼Œç‚¹å‡»è¿›å…¥ HACS åŽï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°å®ƒåœ¨â€œè½¬åœˆâ€æˆ–è€…æç¤ºâ€œæ­£åœ¨èƒŒæ™¯ä¸‹è½½æ•°æ®â€ã€‚è¿™æ˜¯å› ä¸ºå®ƒæ­£åœ¨ä»Ž GitHub æ‹‰å–æˆåƒä¸Šä¸‡ä¸ªæ’ä»¶çš„ç›®å½•åˆ—è¡¨ã€‚


### ï¼ˆå››ï¼‰  æ™ºèƒ½å®¶å±…è®¾å¤‡æŽ¥å…¥
#### å°ç±³ (Xiaomi MIoT)ï¼šæ”¯æŒè´¦å·é›†æˆã€‚
> 1. åœ¨å·¦è¾¹çš„è¾¹æ ç‚¹å‡»HACSï¼Œåœ¨è¿™é‡Œç›´æŽ¥æœç´¢â€œxiaomi miot"
> 2. ç›´æŽ¥ç‚¹å‡»ï¼Œç„¶åŽdownloadï¼Œä¹‹åŽå¼¹å‡ºæ¥ä¸€ä¸ªå°æ¡†ï¼Œä¾ç„¶æ˜¯ç‚¹å‡»downloadï¼Œç­‰å¾…éƒ¨ç½²å®Œæˆï¼Œ
> 3. éƒ¨ç½²å®Œæˆä¹‹åŽï¼Œåœ¨è®¾ç½®é‡Œé¢ç‚¹å‡»æœ€ä¸Šé¢çš„ **ä¸€ä¸ªä¿®å¤** é‚£é‡Œç‚¹å‡»ï¼Œå¼¹å‡ºä¸€ä¸ª"Restart required"çš„è­¦å‘Šï¼Œç‚¹å‡»â€œæäº¤â€->é‡å¯Homeassistant,ç­‰å¾…å‡ åˆ†é’Ÿã€‚
> 4. ç‚¹å‡»è®¾ç½®ï¼Œ ç‚¹å‡»**è®¾å¤‡ä¸ŽæœåŠ¡**ï¼Œ ç‚¹å‡»**æ·»åŠ é›†æˆ**ï¼Œ æœç´¢**xiaomi miot**ï¼Œç‚¹å‡»æ·»åŠ ï¼Œè¿™é‡Œä¼šå¼¹å‡ºä¸€ä¸ªæ¡†æ¥ï¼Œ**é€‰æ‹©æ“ä½œ**ï¼šè¿™é‡Œæˆ‘ä»¬é€‰æ‹©â€œ**Add divices using Mi Account**" (è´¦å·é›†æˆ) **->** ç‚¹å‡»**ä¸‹ä¸€æ­¥**

#### ç¾Žçš„ (Midea AC LAN)ï¼šé‡ç‚¹è®²è§£å¦‚ä½•é€šè¿‡çƒ­ç‚¹ç®¡ç†ç•Œé¢å¯»æ‰¾ç©ºè°ƒ IPã€‚
>1. é¦–å…ˆåœ¨HACSé‡Œå–æœç´¢Midea AC LAN ->download->download->é‡å¯HomeAssistant
>2. åœ¨æ·»åŠ é›†æˆä¹‹å‰ï¼Œéœ€è¦åœ¨æ‰‹æœºä¸Šå®‰è£…ä¸€ä¸ªç¾Žçš„ç¾Žå±…ï¼Œç„¶åŽåœ¨è¿™ä¸ªç¾Žçš„ç¾Žå±…ä¸Šåˆ›å»ºå¥½**è´¦å·**ï¼Œè®¾å®šå¥½**å¯†ç **ï¼Œæ·»åŠ è®¾å¤‡ï¼Œè¿™é‡Œä»¥ç©ºè°ƒä¸ºä¾‹ï¼Œæ‰‹æœºå¦‚æžœæ˜¯è¿žçƒ­ç‚¹çš„è¯å»ºè®®å†æ‰¾ä¸€å°è®¾å¤‡Aç”¨æ¥å¼€çƒ­ç‚¹ï¼Œè®¾å¤‡Bè¿žè®¾å¤‡Açš„çƒ­ç‚¹ï¼Œä¹‹åŽç”¨è®¾å¤‡Bä¸Žç©ºè°ƒè¿žæŽ¥çš„æ—¶å€™ï¼Œä¼šå¼¹å‡ºä¸€ä¸ªç©ºè°ƒçš„WIFIï¼Œç„¶åŽç”¨è®¾å¤‡BåŽ»è¿žæŽ¥ï¼Œè¿žæŽ¥å¥½äº†ä¹‹åŽå°±å¯ä»¥ç”¨è®¾å¤‡Aåœ¨çƒ­ç‚¹é‡Œé¢æ‰¾ç©ºè°ƒçš„**IP**ï¼Œ
>3. è®¾ç½®é‡Œé¢é‡å¯ä¹‹åŽï¼Œç‚¹å‡»**è®¾å¤‡ä¸ŽæœåŠ¡**ï¼Œ ç‚¹å‡»**æ·»åŠ é›†æˆ**ï¼Œ æœç´¢**Midea AC LAN**ï¼Œç‚¹å‡»æ·»åŠ ï¼Œè¿™é‡Œä¼šå¼¹å‡ºä¸€ä¸ªæ¡†æ¥ï¼Œ**é€‰æ‹©æ“ä½œ**ï¼šè¿™é‡Œæˆ‘ä»¬é€‰æ‹©â€œ**Discover automatically**" (è‡ªåŠ¨å‘çŽ°) , åˆ æŽ‰è¾“å…¥æ ä¸­çš„â€œautoâ€ï¼Œç„¶åŽè¾“å…¥**ç©ºè°ƒIPåœ°å€**ï¼Œç„¶åŽå°±ç‚¹ä¸‹ä¸€æ­¥å’Œé€‰æ‹©æ˜¯å“ªä¸ªä½ç½®çš„è®¾å¤‡ï¼Œä¸€èˆ¬éƒ½å·²ç»å†™å¥½äº†ã€‚
>>ä¹‹åŽå°±å¯ä»¥åœ¨æ¦‚è§ˆé‚£é‡Œçœ‹åˆ°æ–°æ·»åŠ çš„ç©ºè°ƒæŽ§åˆ¶çª—å£äº†ã€‚


å¦‚æžœä½ ä½¿ç”¨çš„æ˜¯ docker run å‘½ä»¤è¡Œ
ä½ éœ€è¦åœæ­¢å¹¶åˆ é™¤æ—§å®¹å™¨ï¼Œç”¨æ–°çš„å‘½ä»¤é‡æ–°è¿è¡Œï¼ˆæ•°æ®ä¸ä¼šä¸¢ï¼Œå› ä¸ºä½ æ˜ å°„äº† hass_configï¼‰ã€‚

ä½ çš„æ–°å‘½ä»¤éœ€è¦åŒ…å« --device /dev/gpiomem å’Œ --privilegedï¼š
```
docker stop homeassistant
docker rm homeassistant

docker run -d \
  --name homeassistant \
  --privileged \
  --restart=unless-stopped \
  -e TZ=Asia/Shanghai \
  -v /home/$USER/hass_config:/config \
  --network=host \
  --device /dev/gpiomem:/dev/gpiomem \
  --device /dev/mem:/dev/mem \
  ghcr.io/home-assistant/home-assistant:stable
```


##### ä¿®æ”¹åŽçš„æ­£ç¡®æ ¼å¼
```
switch:
  - platform: rpi_gpio
    switches:
      - port: 17
        name: "Desk LED"
        unique_id: "raspberry_pi_led_17"
```

PWM:
```
light:
  - platform: rpi_gpio
    switches:
      - port: 17
        name: "My PWM LED"
```

```
# 1. é¦–å…ˆç¡®ä¿ä½ çš„åŸºç¡€å¼€å…³é…ç½®æ­£ç¡® (æ³¨æ„ entity_id ä¼šæ˜¯ switch.desk_led)
switch:
  - platform: rpi_gpio
    switches:
      - port: 17
        name: "Desk LED"

# 2. å®šä¹‰ä¸€ä¸ªè™šæ‹Ÿçš„äº®åº¦æ•°å€¼å­˜å‚¨ (ç”¨äºŽæ»‘å—æ»‘åŠ¨)
input_number:
  led_brightness:
    name: "LED Brightness Helper"
    initial: 255
    min: 0
    max: 255
    step: 1

# 3. å®šä¹‰æ¨¡æ¿ç¯
template:
  - light:
      - name: "My LED with Slider"
        unique_id: "my_dimmable_led_new"
        # çŠ¶æ€æ˜¾ç¤ºï¼šæ ¹æ®ç‰©ç†å¼€å…³åˆ¤æ–­æ˜¯å¼€è¿˜æ˜¯å…³
        state: "{{ is_state('switch.desk_led', 'on') }}"
        # äº®åº¦æ˜¾ç¤ºï¼šä»Žè¾…åŠ©å™¨è¯»å–æ•°å€¼
        level: "{{ states('input_number.led_brightness') | int }}"
        
        # ç‚¹å¼€ç¯æ—¶çš„åŠ¨ä½œ
        turn_on:
          action: switch.turn_on
          target:
            entity_id: switch.desk_led
            
        # ç‚¹å…³ç¯æ—¶çš„åŠ¨ä½œ
        turn_off:
          action: switch.turn_off
          target:
            entity_id: switch.desk_led
            
        # æ»‘åŠ¨æ»‘å—æ—¶çš„åŠ¨ä½œ
        set_level:
          # ä¿å­˜æ»‘åŠ¨åŽçš„æ•°å€¼
          - action: input_number.set_value
            target:
              entity_id: input_number.led_brightness
            data:
              value: "{{ brightness }}"
          # æ ¹æ®äº®åº¦å†³å®šæ˜¯å¦å¼€å¯ç‰©ç†å¼€å…³
          - action: >
              {% if brightness > 0 %}
                switch.turn_on
              {% else %}
                switch.turn_off
              {% endif %}
            target:
              entity_id: switch.desk_led
```